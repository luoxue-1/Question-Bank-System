# 个人题库系统

## 系统简介

个人题库系统是一个基于Python开发的本地应用，用于管理个人学习使用的各类题目，支持题目管理、多题库管理、组卷和导出功能。系统采用模块化设计，界面友好，操作简单，适合学生、教师等各类用户使用。

## 技术栈

- Python 3.x
- Tkinter (GUI界面)
- JSON (数据存储)
- python-docx (Word导出)
- reportlab (PDF导出)

## 安装方法

1. **安装Python**
   确保您的系统已安装Python 3.x版本。

2. **安装依赖库**
   打开命令行终端，执行以下命令：
   ```
   pip install python-docx reportlab
   ```

3. **下载系统文件**
   将系统文件下载到本地目录，包括：
   - main.py (主程序)
   - gui.py (GUI界面)
   - data_manager.py (数据管理)
   - question_manager.py (题目管理)
   - paper_generator.py (组卷功能)
   - exporter.py (导出功能)

## 使用说明

### 启动系统

在系统文件所在目录，执行以下命令：
```
python main.py
```

### 题库管理

1. **查看题库**
   - 在题目管理页的"题库"下拉框中查看所有可用题库
   - 系统默认创建一个名为"题库一"的默认题库

2. **管理题库**
   - 点击"题库管理"按钮，打开题库管理窗口
   - 在题库管理窗口中可以：
     - 点击"添加题库"按钮创建新题库
     - 选择题库后点击"修改名称"按钮修改题库名称
     - 选择题库后点击"删除题库"按钮删除不需要的题库（至少保留一个题库）

3. **选择题库**
   - 在题目管理页的"题库"下拉框中选择要操作的题库
   - 在组卷导出页的"题库"下拉框中选择要生成试卷的题库

### 题目管理

1. **新增题目**
   - 在题目管理页的编辑区域填写知识点、题目内容和答案
   - 点击"新增题目"按钮
   - 系统会显示自动消失的成功提示
   - 首次添加后，系统会询问是否进入连续添加模式
   - 进入连续添加模式后，每次添加成功后会自动清空题目内容和答案，保持知识点不变

2. **修改题目**
   - 在题目列表中选择要修改的题目
   - 在编辑区域修改题目信息
   - 点击"保存修改"按钮

3. **删除题目**
   - 在题目列表中选择要删除的题目
   - 点击"删除题目"按钮
   - 在弹出的确认对话框中点击"确定"

4. **批量删除题目**
   - 在题目列表中按住Ctrl键选择多个题目
   - 点击"批量删除"按钮
   - 在弹出的确认对话框中点击"确定"

5. **筛选题目**
   - 在知识点筛选下拉框中选择要筛选的知识点
   - 系统会自动筛选显示该知识点的题目

6. **搜索题目**
   - 在搜索框中输入关键词
   - 点击"搜索"按钮
   - 系统会显示包含关键词的题目

7. **排序题目**
   - 点击题目列表中的"ID"列标题，可以对题目按ID进行排序

8. **上传Word文档**
   - 点击"上传Word文档"按钮
   - 选择包含题目的Word文档
   - 输入知识点
   - 系统会自动解析文档中的题目并添加到当前题库

### 组卷导出

1. **生成试卷**
   - 在组卷导出页选择要使用的题库
   - 从知识点列表中选择要包含的知识点（可选）
   - 输入题目数量
   - 点击"生成试卷"按钮
   - 系统会在右侧显示生成的试卷和答案

2. **导出试卷**
   - 生成试卷后，点击"导出试卷为Word"或"导出试卷为PDF"按钮
   - 系统会在当前目录生成"试卷.docx"或"试卷.pdf"文件

3. **导出答案**
   - 生成试卷后，点击"导出答案为Word"或"导出答案为PDF"按钮
   - 系统会在当前目录生成"答案.docx"或"答案.pdf"文件

## 功能介绍

### 核心功能

1. **题目管理**
   - 增删改查题目
   - 知识点分类
   - 按知识点筛选
   - 关键词搜索
   - 批量删除题目
   - Word文档上传解析
   - 连续添加模式

2. **多题库管理**
   - 支持创建多个题库
   - 题库名称自定义
   - 题目按题库分类管理
   - 组卷时选择特定题库

3. **组卷功能**
   - 按知识点随机抽题
   - 自定义题目数量
   - 试卷与答案完全分离
   - 从指定题库生成试卷

4. **导出功能**
   - 试卷导出为Word格式
   - 试卷导出为PDF格式
   - 答案导出为Word格式
   - 答案导出为PDF格式

5. **界面功能**
   - 题目列表排序
   - 题库列表排序
   - 知识点自动提示
   - 自动消失的成功提示

### 界面设计

- **双标签页**：题目管理页 + 组卷导出页
- **题目管理页**：题库选择+筛选框+题目列表(带排序)+编辑区域+功能按钮
- **组卷导出页**：题库选择+知识点选择+参数设置+试卷显示区+答案显示区+导出按钮

## 数据结构

系统使用questions.json文件存储题目数据，数据结构如下：

```json
{
  "banks": [
    {
      "id": 1,
      "name": "题库一",
      "questions": [
        {
          "id": 1,
          "topic": "数学",
          "content": "1+1=?",
          "answer": "2"
        },
        {
          "id": 2,
          "topic": "英语",
          "content": "What is your name?",
          "answer": "My name is..."
        }
      ]
    }
  ]
}
```

## 注意事项

1. **数据安全**
   - 系统数据存储在本地questions.json文件中，请妥善保管该文件
   - 定期备份questions.json文件，以防数据丢失

2. **依赖库**
   - 系统需要python-docx和reportlab库才能实现导出功能
   - 如果未安装这些库，系统仍然可以运行，但无法导出文件

3. **题目数量**
   - 生成试卷时，题目数量不能超过所选题库中符合条件的题目总数
   - 如果未选择知识点，题目数量不能超过所选题库中的题目总数

4. **文件命名**
   - 导出的文件会覆盖同名文件，请确保导出前备份重要文件

5. **连续添加模式**
   - 进入连续添加模式后，点击"退出"按钮可以退出该模式

6. **题库管理**
   - 系统至少需要保留一个题库，无法删除所有题库

## 常见问题

1. **启动失败**
   - 检查Python是否正确安装
   - 检查依赖库是否安装成功

2. **导出失败**
   - 检查依赖库是否安装成功
   - 检查当前目录是否有写入权限

3. **题目不显示**
   - 检查questions.json文件是否存在
   - 检查questions.json文件格式是否正确
   - 检查是否选择了正确的题库

4. **Word文档上传失败**
   - 检查Word文档格式是否正确
   - 确保文档中的题目符合系统解析格式

5. **连续添加模式无法退出**
   - 点击编辑区域中的"退出"按钮可以退出连续添加模式

## 联系方式

如果您在使用过程中遇到问题，欢迎联系开发者寻求帮助。
